<div align="center">
<h1>vb-design</h1>
<p>åŸºäºpnpmåˆ›å»ºçš„Monorepoå¤šåŒ…é¡¹ç›®</p>
</div>

## åˆå§‹åŒ–
```
pnpm install
```

## å¼€å‘

```
cd examples/demo

pnpm run dev
```

## æ‰“åŒ…
```
pnpm run build
```

## å‘å¸ƒ
```
pnpm run release:only
```


# Monorepoæ¦‚å¿µ
### éšç€å„ç§æŠ€æœ¯çš„å‘å±•å’Œè¶…çº§åº”ç”¨çš„å‡ºç°ï¼Œäººä»¬å¼€å§‹è€ƒè™‘æ€ä¹ˆæ‰èƒ½å°†æ‰€æœ‰çš„å°åº”ç”¨éƒ½é›†æˆåœ¨ä¸€ä¸ªå¤§é¡¹ç›®ä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿™äº›é¡¹ç›®äº’ç›¸å½±å“æ—¶ï¼Œåœ¨å®ç°è¿‡ç¨‹ä¸­ï¼Œå·¥ç¨‹å¸ˆä»¬æœ€å…³æ³¨çš„ä¸¤ç‚¹æ˜¯ï¼šé¡¹ç›®åŠŸèƒ½åˆ†ç¦»Â å’Œ é¿å…é‡å¤ä»£ç ã€‚
### å¦‚æœå°†æ¯ä¸ªåŠŸèƒ½ä½œä¸ºç‹¬ç«‹çš„é¡¹ç›®æ‰“åŒ…ï¼Œéšç€ä¸šåŠ¡çš„å‘å±•ï¼Œé¡¹ç›®ä¼šè¶Šæ¥è¶Šå¤šï¼Œæ ¹æœ¬æ²¡æ³•ç®¡ç†ï¼Œé¡¹ç›®ä¸é¡¹ç›®ä¹‹é—´çš„åä½œä¹Ÿä¼šè¶Šæ¥è¶Šå›°éš¾ï¼Œæ‰€ä»¥Monorepoçš„æ¦‚å¿µå¹¶äº§ç”Ÿäº†ã€‚
åœ¨Monorepoä¸­æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªé¡¹ç›®ä¸‹è¿›è¡ŒåŠŸèƒ½æ‹†åˆ†ï¼Œä»–ä»¬äº’ç›¸ç‹¬ç«‹ä¸å½±å“ï¼Œä½†æ˜¯åˆå¯ä»¥é€šè¿‡å¼•ç”¨æ¥è¾¾åˆ°äº’ç›¸ååŠ©ã€‚

# Monorepoçš„ä¼˜ç¼ºç‚¹

## ä¼˜ç‚¹ï¼š

### ç®€åŒ–ä¾èµ–çš„ç®¡ç†ã€‚
### è·¨ç»„åˆä½œæ›´åŠ æ–¹ä¾¿ã€‚
### ä»£ç å¤ç”¨ç®€å•ã€‚

## ç¼ºç‚¹ï¼š

### é¡¹ç›®æ„å»ºæ—¶é—´è¿‡é•¿ã€‚
### ç‰ˆæœ¬ä¿¡æ¯æ‚ç³…ä¸æ¸…æ™°ã€‚

# é¡¹ç›®å·¥ç¨‹çš„æ­å»º
## æŠ€æœ¯é€‰å‹
### åŸºäºpnpmçš„Monorepoå·¥ç¨‹ï¼Œé¡¹ç›®æ‰“åŒ…å·¥å…·viteã€gulpï¼Œä½¿ç”¨sasså¤„ç†æ ·å¼ã€‚
### Vueç»„ä»¶å†™æ³•ä¼šæ”¯æŒJsxå’Œtemplateçš„æ–¹å¼ã€‚é¡¹ç›®æ”¯æŒTypescriptã€‚
### lintè§„èŒƒçš„æ¥å…¥ï¼Œprettierçš„æ ¼å¼åŒ–ç»Ÿä¸€ï¼Œhuskyçš„å¡ç‚¹æ ¡éªŒã€‚
### ç»„ä»¶å•å…ƒæµ‹è¯•ä½¿ç”¨vitest+happy-domã€‚

åŸºäºä»¥ä¸Šçš„æŠ€æœ¯å¼€å§‹æ­å»ºæˆ‘ä»¬çš„é¡¹ç›®ã€‚
### é¡¹ç›®çš„å¤§æ¦‚ç»“æ„
```
|â€”â€” config        //æ”¾ç½®ä¸€äº›è„šæœ¬
|â€”â€” examples      //å­˜æ”¾æ¼”ç¤ºåŒ…
    |â€”â€” demo
    |â€”â€” taro-demo 
    ...
|â€”â€” packages      //å­˜æ”¾npmåº“çš„åŒ…
    |â€”â€” hooks
    |â€”â€” icon
    |â€”â€” ui-h5
    |â€”â€” ui-taro
    ...
.eslintignore
.eslintrc.js
.gitignore
.lintstagedrc.cjs
.npmrc
.prettierrc.cjs
package.json
pnpm-workspace.yaml
README.md
tsconfig.root.json
...
```

## é¡¹ç›®é…ç½®
### Monerepoå·¥ç¨‹çš„èµ·æ­¥

pnpmæ­å»ºMonorepoæ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€è¦æˆ‘ä»¬é…ç½®pnpm-workspace.yamlæ–‡ä»¶å³å¯ã€‚å…·ä½“çš„é…ç½®å¯å‚è€ƒpnpm-workspace.yaml | pnpm

### lintã€prettierã€eslintçš„æ¥å…¥
lintã€prettierã€eslintçš„é…ç½®å¤§éƒ¨äººåº”è¯¥éƒ½å¾ˆç†Ÿç»ƒäº†ï¼Œåœ¨è¿™æˆ‘å°±ä¸ä¸€ä¸€è´´ä»£ç è¯´æ˜äº†ã€‚è¿˜ä¸æ¸…æ¥šçš„å°ä¼™ä¼´å¯å‚è€ƒæˆ‘çš„ä»£ç æˆ–è€…æ‰¾ç¯‡ç›¸å…³çš„æ•™ç¨‹è‡ªå·±è·Ÿç€è¯•è¯•ã€‚

## ç»Ÿä¸€å¼€å‘ç¯å¢ƒ

## å¼€å‘ç¯å¢ƒçš„ç»Ÿä¸€ï¼Œä¸»è¦æ˜¯ç»Ÿä¸€Nodeç‰ˆæœ¬å’Œpnpmï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨package.jsonä¸­é…ç½®ä¸€äº›å­—æ®µæ¥ç»Ÿä¸€å¼€å‘ç¯å¢ƒã€‚
### 1ã€é™åˆ¶Nodeç‰ˆæœ¬å’Œpnpm
é€šè¿‡é…ç½®voltaå’Œenginesé™åˆ¶Nodeå’Œpnpmçš„ç‰ˆæœ¬
```
//package.json

"volta": {
    "node": "16.13.0"
},
"engines": {
    "node": "16.13.0",
    "pnpm": ">=6"
}
```

### 2ã€é™åˆ¶é¡¹ç›®åªèƒ½é€šè¿‡pnpmåˆå§‹åŒ–ä¾èµ–
```
//package.json

"scripts": {
    "preinstall": "npx only-allow pnpm",
}
```
### packageså­åŒ…æ­å»º
å¯¹äºå­åŒ…çš„æ­å»ºï¼Œä¸ä¼šè¯¦ç»†åœ°ä¸€ä¸€è®²è§£ï¼Œéœ€è¦æ·±å…¥äº†è§£çš„å¯ä»¥è‡ªè¡Œåˆ°æºä»£ç é‡Œçœ‹ã€‚
### ui-h5æ­å»º
ç›®å½•ç»“æ„è®¾è®¡
```
//ui-h5

components                  //ç»„ä»¶ç›®å½•
    |â€”â€” Button
        |â€”â€” demo            //demoæ¼”ç¤ºå­˜æ”¾ç›®å½•
            |â€”â€” base.vue
            ...
        |â€”â€” index.md        //ç»„ä»¶ä½¿ç”¨æ–‡æ¡£
        |â€”â€” index.scss      //ç»„ä»¶æ ·å¼
        |â€”â€” index.ts        //vueç»„ä»¶
        |â€”â€” index.taro.ts   //taroç»„ä»¶
    |â€”â€” Icon
    ...
style          //å…¬å…±æ ·å¼å­˜æ”¾
    |â€”â€” index.scss
    ...
ui.h5.ts       //vueç»„ä»¶å¯¹å¤–æš´éœ²
ui.taro.ts     //taroç»„ä»¶å¯¹å¤–æš´éœ²
```

ä¸ºäº†å¼€å‘æ–¹ä¾¿ï¼ŒæŠŠvueç«¯ã€taroç«¯çš„ç»„ä»¶éƒ½æ”¾åœ¨è¯¥åŒ…ä¸‹ï¼Œä»¥åŠexampleséœ€è¦çš„æ¼”ç¤ºæ–‡æ¡£å’Œdemoä¹Ÿæ”¾åœ¨è¯¥åŒ…ä¸‹ã€‚è‡³äºå„ç«¯å†™å¥½çš„ç»„ä»¶ã€demoã€æ¼”ç¤ºæ–‡æ¡£æ˜¯æ€ä¹ˆä½¿ç”¨ï¼Œåç»­ä¼šè¯´æ˜ã€‚

### æ„å»ºäº§ç‰©
```
// dist
components                    //å•ä¸ªç»„ä»¶
    |â€”â€” Button
        |â€”â€” index.scss
        |â€”â€” index.css
        |â€”â€” index.js
        |â€”â€” index.taro.js
    |â€”â€” Icon
    ...
style 
    |â€”â€” index.scss
    ...
types
    |â€”â€” 
    ...
style.css
vb-ui.es.js
vu-ui.umd.js
vb-ui.taro.es.js
vb-ui.taro.umd.js
```

### ui-taroæ­å»º
è¯¥åŒ…å…¶å®æ²¡æœ‰åšæ›´å¤šçš„äº‹æƒ…ï¼Œåªæ˜¯åˆå§‹åŒ–ä¹‹åæŠŠpackage.jsonåšäº†ç›¸å…³é…ç½®ã€‚æœ€é‡è¦çš„åœ°æ–¹æ˜¯åœ¨æ ¹ç›®å½•ä¸‹çš„package.jsoné…ç½®äº†è„šæœ¬ï¼Œåœ¨ui-h5åŒ…æ„å»ºä¹‹åï¼Œé€šè¿‡è„šæœ¬copyäº†è¯¥åŒ…éœ€è¦çš„ä¸œè¥¿ã€‚

è„šæœ¬æ–‡ä»¶éƒ½åœ¨æ ¹ç›®å½•configé‡Œ

### iconæ­å»º
åœ¨ui-h5ä¸­ï¼ŒIconç»„ä»¶çš„è®¾è®¡æ”¯æŒäº†iconfontå’Œsvgçš„æ–¹å¼ï¼Œè¿™ä¹Ÿæ˜¯å‚è€ƒäº†element-uiçš„Iconç»„ä»¶è®¾è®¡ã€‚æ‰€ä»¥è¯¥åŒ…ä¸»è¦æ˜¯å¤„ç†svgå›¾æ ‡ï¼ŒæŠŠå›¾æ ‡è½¬åŒ–æˆvueç»„ä»¶ç»Ÿä¸€å‘å¤–æš´éœ²çš„è¿‡ç¨‹ã€‚

å¦å¤–ï¼Œæˆ‘å¹¶ä¸ä¼šç”¨è®¾è®¡è½¯ä»¶ï¼Œæ²¡æœ‰svgå¯ç”¨ï¼Œæ‰€ä»¥å€Ÿç”¨äº†å­—èŠ‚arco-designçš„å›¾æ ‡Arco Design Icons â€“ Figma

### hooksæ­å»º

è¯¥åŒ…ä¸»è¦æ˜¯ä¸€äº›å…¬å…±æ–¹æ³•çš„åŒ…ï¼Œç›®å‰ä¹Ÿæ²¡æœ‰æ›´å¤šçš„æƒ³æ³•ï¼Œæ‰€ä»¥ä¹Ÿåªæ˜¯å…ˆæ”¾ç€ã€‚

### examplesæµè§ˆå™¨ç«¯æ¼”ç¤ºåŒ…æ­å»º
å› ä¸ºæ­å»ºçš„æ˜¯ç§»åŠ¨ç«¯ç»„ä»¶åº“ï¼Œæ‰€ä»¥æ¼”ç¤ºåŒ…éœ€è¦æœ‰ä¸¤ä¸ªå…¥å£ï¼ŒH5ç«¯å’ŒPCç«¯ã€‚æ•´ä¸ªæ­å»ºçš„è¿‡ç¨‹å¤§è‡´æ˜¯ï¼š

é€šè¿‡vite-plugin-mdè§£æmdæ–‡ä»¶ã€‚

é€šè¿‡vite-plugin-pageså’Œvite-plugin-vue-layoutsç®¡ç†è·¯ç”±ï¼Œé¡µé¢çš„å­˜æ”¾è·¯å¾„æ˜¯åœ¨ui-h5åŒ…ä¸‹ã€‚

vite-plugin-pageså’Œvite-plugin-vue-layoutsçš„é…ç½®
```
//vite.config.js

Pages({
  dirs: [
    {
      dir: resolve(__dirname, '../../packages/ui-h5/components'),
      baseRoute: 'component',
    },
  ],
  exclude: ['**/components/*.vue'],
  extensions: ['vue', 'md'],
}),
Layout({
  layoutsDirs: 'src/layouts',
  defaultLayout: 'preview',
})
```
### é¡¹ç›®çš„æ„å»ºä¸npmåŒ…å‘å¸ƒ
è¿™ä¹ˆå¤šçš„å­åŒ…ï¼Œæ‰“åŒ…æ„å»ºä»¥åŠæ¨é€åˆ°npmæ˜¯ä¸æ˜¯éœ€è¦åˆ°æ¯ä¸ªå­åŒ…ä¸‹æ‰§è¡Œå®Œæ‰“åŒ…å’Œæ‰§æ¨é€çš„å‘½ä»¤ï¼Ÿé’ˆå¯¹è¿™ä¸ªé—®é¢˜pnpmå®˜æ–¹æ˜¯æœ‰è§£å†³æ–¹æ¡ˆçš„ï¼š

é¦–å…ˆæ‰€æœ‰çš„å­åŒ…éƒ½å®šä¹‰ä¸ªbuildå‘½ä»¤æ¥æ‰§è¡Œå½“å‰åŒ…çš„æ‰€æœ‰æ‰“åŒ…æ„å»ºäº‹æƒ…ï¼Œæœ€åé¡¹ç›®æ ¹ç›®å½•package.jsonçš„é…ç½®å¦‚ä¸‹ï¼š
```
//package.json

"scripts": {
    "build": "pnpm --filter './packages/**' run build && pnpm run build:taro",  //æ‰§è¡Œpackagesä¸‹æ‰€æœ‰å­åŒ…çš„buildæ–¹æ³•
    "release": "pnpm run build && pnpm run release:only",
    "release:only": "changeset publish --tag=beta --access=publish",            //å‘å¸ƒæ‰€æœ‰å­åŒ…
    "build:taro": "node ./config/build-taro.js",
    "build:demo": "pnpm --filter './examples/**' run build"
}

```
ä¸Šæ–¹buildè¿™ä¸ªåœ°æ–¹çš„é…ç½®pnpmå®˜æ–¹æœ‰å¾ˆè¯¦ç»†çš„è¯´æ˜ã€‚å†å°±æ˜¯å…³äºnpm publishçš„ï¼Œä¸»è¦æ˜¯é€šè¿‡@changesets/cliè¿™ä¸ªcliå·¥å…·å»è§£å†³ã€‚

changeset publishÂ åªæ˜¯ä¸€ä¸ªå¾ˆçº¯å‡€çš„å‘åŒ…å‘½ä»¤ï¼Œæ‰‹åŠ¨æå‡/ä¿®æ”¹ç‰ˆæœ¬åå†Â changeset publishä»–ä¼šå°†æ‰€æœ‰åŒ…éƒ½publishä¸€æ¬¡ã€‚

å†™åˆ°è¿™ï¼Œé¡ºä¾¿å†ç»™å¤§å®¶è¯´ä¸‹è¿™ä¸ªé¡¹ç›®çš„ä»£ç å‘å¸ƒæµå§ã€‚

ç‰ˆæœ¬å·æ˜¯æ‰‹åŠ¨ä¿®æ”¹çš„ã€‚

é€šè¿‡æ‰“tagçš„æ–¹å¼ä¼šè§¦å‘workflowså»æ‰§è¡Œæ‰“åŒ…æ„å»ºï¼Œç„¶åpublishå’Œéƒ¨ç½²æ¼”ç¤ºçš„demoã€‚

å¾ˆå¤šå¼€æºçš„é¡¹ç›®é€šè¿‡changeset-bot + changesets/action + @changesets/clièƒ½ç©å‡ºå„ç§å„æ ·çš„å·¥ä½œæµã€‚

### å…³äºå•å…ƒæµ‹è¯•
å•æµ‹åœ¨å¼€æºé¡¹ç›®é‡Œæ˜¯ä¸å¯ç¼ºå°‘çš„å­˜åœ¨ï¼Œè™½ç„¶æˆ‘ä¸ä¸€å®šä¼šå»å†™å•æµ‹ğŸ˜€ï¼Œä½†æ˜¯è¯¥æœ‰çš„ä¸œè¥¿è¿˜æ˜¯å¾—æ­èµ·æ¥ã€‚

Vitestæ˜¯åŸºäºviteçš„åŸç”Ÿå¿«é€Ÿå•å…ƒæµ‹è¯•ï¼Œå®Œå…¨å…¼å®¹Jestçš„Apiï¼Œè¿˜èƒ½å…±ç”¨viteçš„é…ç½®ã€‚æ‰€ä»¥é’ˆå¯¹å½“å‰é¡¹ç›®ä½¿ç”¨Vitestæ˜¯æœ€å¿«æ¥å…¥å•å…ƒæµ‹è¯•çš„æ–¹å¼ï¼Œä½†æ˜¯å¾ˆé—æ†¾ï¼Œé’ˆå¯¹å°ç¨‹åºç«¯è¿˜æ²¡æœ‰æ›´å¥½çš„æ¥å…¥å•å…ƒæµ‹è¯•æ–¹æ¡ˆã€‚
